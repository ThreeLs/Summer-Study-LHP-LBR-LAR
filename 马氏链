马氏链
马氏链原理
马尔可夫预测法是应用概率论中马尔可夫链（Markov chain）的理论和方法来研究分析时间序列的变化规律，并由此预测其未来变化趋势的一种预测技术．这种技术已在市场预测分析和市场管理决策中得到广泛应用，近年来逐步被应用于卫生事业管理和卫生经济研究中．下面扼要介绍马尔可夫链的基本原理以及简单运用。当系统的每个时期所处的状态是随机的，从这个时期到下个时期的状态按照一定的概率进行转移，并且下个时期的状态只取决于这个时期的状态和转移概率，与以前各个时期状态无关，此时可以用马氏链模型解决问题。
模型建立过程
我们知道，要描述某种特定时期的随机现象如某种药品在未来某时期的销售情况，比如说第n季度是畅销还是滞销，用一个随机变量Xn便可以了，但要描述未来所有时期的情况，则需要一系列的随机变量 X1，X2，…，Xn，…．称{ Xt，t∈T ，T是参数集}为随机过程，{ Xt }的取值集合称为状态空间．若随机过程{ Xn }的参数为非负整数， Xn 为离散随机变量，且{ Xn }具有无后效性（或称马尔可夫性），则称这一随机过程为马尔可夫链（简称马氏链）．所谓无后效性，直观地说，就是如果把{ Xn }的参数n看作时间的话，那么它在将来取什么值只与它现在的取值有关，而与过去取什么值无关．
对具有N个状态的马氏链，描述它的概率性质，最重要的是它在n时刻处于状态i下一时刻转移到状态j的一步转移概率：

若假定上式与n无关，即，则可记为（此时，称过程是平稳的），并记
               （1）
称为转移概率矩阵．
转移概率矩阵具有下述性质：
（1）．即每个元素非负．
（2）．即矩阵每行的元素和等于1．
如果我们考虑状态多次转移的情况，则有过程在n时刻处于状态i，n+k时刻转移到状态j的k步转移概率：

同样由平稳性，上式概率与n无关，可写成．记

称为k步转移概率矩阵．其中具有性质：
 
插入点
本模型的关键就是设法将状态之间的影响用矩阵的形式表现出来，将状态赋予数据，抽象成向量，模型中各时期状态只与上一时期状态相关这个条件具有至关重要的作用，它保证了有关状态转移的计算可以用连乘的方式去实现
例1  设某抗病毒药销售情况分为“畅销”和“滞销”两种，以“1”代表“畅销”，“2”代表“滞销”．以Xn表示第n个季度的销售状态，则Xn可以取值1或2．若未来的抗病毒药销售状态，只与现在的市场状态有关，而与以前的市场状态无关，则抗病毒药的市场状态{ Xn ，n≥1}就构成一个马氏链．设
， ， ， 
则转移概率矩阵为

这里表示连续畅销的可能性，表示由畅销转入滞销的可能性，表示由滞销转入畅销的可能性，表示连续滞销的可能性．这种状态转移的情况也可以用状态转移图来表示.
若本季度抗病毒药的销售处于畅销（即处于状态“1” ），那么，经过两个季度以后，就经历了两次转移，可能转移到状态“2”，也可能保持状态“1”，这种转移的可能性的大小就是二步转移概率．
表示抗病毒药的销售由畅销经两次转移后仍然是畅销的概率，由概率计算的全概率公式



同样可算得由畅销经两次转移到滞销的概率


由滞销经两次转移到畅销和滞销的概率分别为


所以二步转移矩阵为

由例2的计算过程知




一般地有，若为一步转移矩阵，则k步转移矩阵
     
